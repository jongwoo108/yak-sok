# 08. ë³µì•½ ìº˜ë¦°ë” ê¸°ëŠ¥

> ì‘ì„±ì¼: 2026-01-17

## ê°œìš”

ë³µì•½ ìº˜ë¦°ë”ëŠ” ì›”ë³„ ë³µì•½ í˜„í™©ì„ ì‹œê°í™”í•˜ê³ , ë³‘ì› ë°©ë¬¸ì¼ì„ ìë™ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ í‘œì‹œí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

---

## 1. ë³µì•½ ìº˜ë¦°ë”

### 1.1 ê¸°ëŠ¥ ì„¤ëª…

- **ì›”ë³„ ë³µì•½ í˜„í™©**: ê° ë‚ ì§œë³„ ë³µì•½ ì™„ë£Œ/ì¼ë¶€/ë¯¸ë³µìš© ìƒíƒœë¥¼ ìƒ‰ìƒ ì ìœ¼ë¡œ í‘œì‹œ
- **ë³‘ì› ë°©ë¬¸ì¼ í‘œì‹œ**: ì²˜ë°© ì¼ìˆ˜ ê¸°ë°˜ìœ¼ë¡œ ì•½ì´ ë–¨ì–´ì§€ëŠ” ë‚ ì„ íŒŒë€ìƒ‰ìœ¼ë¡œ í‘œì‹œ
- **ì¼ë³„ ìƒì„¸ ì¡°íšŒ**: ë‚ ì§œ ì„ íƒ ì‹œ í•´ë‹¹ ë‚ ì§œì˜ ë³µì•½ ê¸°ë¡ í‘œì‹œ
- **ì¼ê´„ ìˆ˜ì •**: ê°™ì€ ë‚ ì§œì˜ ì—¬ëŸ¬ ì•½ ì²˜ë°© ì¼ìˆ˜ë¥¼ í•œ ë²ˆì— ìˆ˜ì •

### 1.2 ë°ì´í„° ëª¨ë¸

```python
# backend/apps/medications/models.py

class Medication(models.Model):
    # ê¸°ì¡´ í•„ë“œ...
    
    # ë³‘ì› ë°©ë¬¸ì¼ ê³„ì‚°ìš© í•„ë“œ ì¶”ê°€
    days_supply = models.PositiveIntegerField(
        null=True,
        blank=True,
        verbose_name='ì²˜ë°© ì¼ìˆ˜'
    )
    start_date = models.DateField(
        null=True,
        blank=True,
        verbose_name='ë³µìš© ì‹œì‘ì¼'
    )
    
    @property
    def end_date(self):
        """ì²˜ë°© ì¢…ë£Œì¼ (= ë‹¤ìŒ ë³‘ì› ë°©ë¬¸ì¼) ê³„ì‚°"""
        if self.start_date and self.days_supply:
            from datetime import timedelta
            return self.start_date + timedelta(days=self.days_supply)
        return None
```

### 1.3 API ì—”ë“œí¬ì¸íŠ¸

#### ìº˜ë¦°ë” ë°ì´í„° ì¡°íšŒ

```
GET /api/medications/logs/calendar/?year=2026&month=1
```

**ì‘ë‹µ:**
```json
{
    "daily_summary": {
        "2026-01-15": {
            "total": 3,
            "taken": 3,
            "missed": 0
        },
        "2026-01-16": {
            "total": 3,
            "taken": 1,
            "missed": 2
        }
    },
    "hospital_visits": [
        {
            "date": "2026-02-14",
            "medication_id": 1,
            "medication_name": "í˜ˆì••ì•½",
            "days_supply": 30
        }
    ]
}
```

### 1.4 ìº˜ë¦°ë” ë§ˆì»¤ ìƒ‰ìƒ

| ìƒ‰ìƒ | Hex ì½”ë“œ | ì˜ë¯¸ |
|------|----------|------|
| ì´ˆë¡ | `#66BB6A` | ëª¨ë“  ì•½ ë³µìš© ì™„ë£Œ |
| ë…¸ë‘ | `#FFC107` | ì¼ë¶€ ë³µìš© |
| ë¹¨ê°• | `#EF5350` | ë¯¸ë³µìš© |
| íŒŒë‘ | `#2196F3` | ë³‘ì› ë°©ë¬¸ì¼ |

### 1.5 í™”ë©´ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ë³µì•½ ìº˜ë¦°ë”               â”‚
â”‚    ë§¤ì¼ì˜ ë³µì•½ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ì™„ë£Œâ—] [ì¼ë¶€â—] [ë¯¸ë³µìš©â—] [ë³‘ì›â—]  â”‚  â† ë²”ë¡€
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         < 2026ë…„ 1ì›” >              â”‚
â”‚  ì¼  ì›”  í™”  ìˆ˜  ëª©  ê¸ˆ  í†          â”‚
â”‚           1   2   3   4             â”‚
â”‚   5   6   7   8   9  10  11        â”‚
â”‚  12  13  14  15â— 16â— 17  18        â”‚  â† ë‚ ì§œë³„ ë§ˆì»¤
â”‚  ...                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¥ ë³‘ì› ë°©ë¬¸ì¼                     â”‚  â† ì„ íƒëœ ë‚ ì§œê°€ ë³‘ì› ë°©ë¬¸ì¼ì¸ ê²½ìš°
â”‚  í˜ˆì••ì•½ - 30ì¼ì¹˜ ì²˜ë°© ì¢…ë£Œ          â”‚
â”‚  [3ê°œ ì•½ ì¼ê´„ ìˆ˜ì •]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2026ë…„ 1ì›” 15ì¼ ìˆ˜ìš”ì¼             â”‚
â”‚  âœ… ëª¨ë“  ì•½ ë³µìš© ì™„ë£Œ (3/3)         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  âœ“ í˜ˆì••ì•½ - ì•„ì¹¨ â€¢ 1ì •              â”‚
â”‚  âœ“ ë‹¹ë‡¨ì•½ - ì ì‹¬ â€¢ 1ì •              â”‚
â”‚  âœ“ ì˜ì–‘ì œ - ì €ë… â€¢ 2ì •              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì²˜ë°©ì „ ìŠ¤ìº” ì‹œ ì²˜ë°© ì¼ìˆ˜ ì…ë ¥

### 2.1 ê¸°ëŠ¥ ì„¤ëª…

ì²˜ë°©ì „ì„ ìŠ¤ìº”í•  ë•Œ ì²˜ë°© ì¼ìˆ˜ë¥¼ ì…ë ¥í•˜ë©´:
1. `start_date`ê°€ ìŠ¤ìº” ì‹œì (ì˜¤ëŠ˜)ìœ¼ë¡œ ìë™ ì„¤ì •
2. `end_date`ê°€ ìë™ ê³„ì‚°ë˜ì–´ ìº˜ë¦°ë”ì— ë³‘ì› ë°©ë¬¸ì¼ë¡œ í‘œì‹œ

### 2.2 í™”ë©´ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ì²˜ë°© ì¼ìˆ˜                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           30                â”‚ ì¼ â”‚  â† ìˆ«ì ì…ë ¥
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  ì…ë ¥í•˜ë©´ ì•½ì´ ë–¨ì–´ì§€ëŠ” ë‚ ì„         â”‚
â”‚  ìº˜ë¦°ë”ì— í‘œì‹œí•©ë‹ˆë‹¤                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  ğŸ“… ë‹¤ìŒ ë³‘ì› ë°©ë¬¸ì¼: 2ì›” 16ì¼      â”‚  â† ìë™ ê³„ì‚°ëœ ë‚ ì§œ ë¯¸ë¦¬ë³´ê¸°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ê´€ë ¨ íŒŒì¼ ëª©ë¡

### Backend

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `apps/medications/models.py` | `days_supply`, `start_date` í•„ë“œ ì¶”ê°€ |
| `apps/medications/serializers.py` | `end_date` ì§ë ¬í™” ì¶”ê°€ |
| `apps/medications/views.py` | ìº˜ë¦°ë” APIì— `hospital_visits` ì¶”ê°€ |

### Mobile (React Native)

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `app/(tabs)/calendar.tsx` | ë³µì•½ ìº˜ë¦°ë” í™”ë©´ |
| `app/(tabs)/_layout.tsx` | íƒ­ ìˆœì„œ ë³€ê²½ (í™ˆ-ë‚´ì•½-ìº˜ë¦°ë”-ì„¤ì •) |
| `app/medications/add.tsx` | ì²˜ë°© ì¼ìˆ˜ ì…ë ¥ í•„ë“œ ì¶”ê°€ |
| `app/medications/scan.tsx` | ì²˜ë°© ì¼ìˆ˜ ì…ë ¥ + start_date ìë™ ì„¤ì • |
| `services/api.ts` | ìº˜ë¦°ë” API ì¶”ê°€ |
| `services/types.ts` | `CalendarData`, `HospitalVisit` íƒ€ì… ì¶”ê°€ |

---

## 4. ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
cd backend
python manage.py makemigrations medications
python manage.py migrate
```

ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼:
- `medications/0004_medication_days_supply_medication_start_date.py`
